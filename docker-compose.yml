services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: laravel-octane-web
    restart: unless-stopped
    env_file: .env.docker
    command: php artisan octane:frankenphp --host=0.0.0.0 --port=8000
    ports:
      - "${APP_PORT:-8000}:8000"

  test:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: laravel-octane-test
    env_file: .env.docker
    command: php artisan test:env
    depends_on:
      - web

networks:
  default:
    driver: bridge
